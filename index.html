<!DOCTYPE html>
<html>
<head>
<title>Donation & Expense Management</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
/* ====== ORIGINAL DESIGN (UNCHANGED) ====== */
.cardd{
    width: 90%;
    height: 230px;
    background: hsl(214, 35%, 67%);
    border-radius: 20px;
    display: flex;
    justify-content: center;
    align-items: center;
    position: relative;
    overflow: hidden;
}
.cardd p{
    z-index: 2;
    position: relative;
    color: #ffffff;
}
.cardd::before{
    content: "";
    position: absolute;
    width: 50%;
    height: 180%;
    background: linear-gradient(180deg, #ea00ff, #04ff64);
    animation: rotate 3s linear infinite;
}
.cardd::after{
    content: "";
    position: absolute;
    inset: 5px;
    background: #07182E;
    border-radius: 15px;
    z-index: 1;
}
@keyframes rotate{
    from{ transform: rotate(0deg); }
    to{ transform: rotate(360deg); }
}
body{
    font-family: Arial, sans-serif;
    background: #dce5f3;
    margin:0 auto;
    padding:10px;
    width: 400px;
}
.header{
    font-size: 20px;
    font-weight: bold;
    margin-bottom: 20px;
    text-align: center;
    width: 95%;
}
.card{
    background: rgb(255, 255, 255);
    padding: 20px;
    display: flex;
    flex-direction: column;
    margin-bottom: 20px;
    border-radius: 12px;
    box-shadow: 0 0 12px rgba(0,0,0,0.1);
}
button{
    padding: 20px;
    border:none;
    border-radius:20px;
    background:#007bff;
    color:white;
    cursor:pointer;
    font-size: 26px;
    margin-top: 20px;
}
button:hover{ background:#063c77; }
input{
    width: 90%;
    padding:14px;
    margin:8px 0;
    font-size: 16px;
    border-radius:5px;
    border:1px solid #ccc;
}
.hidden{display:none;}

/* ===== Mobile friendly table (ONLY THIS PART ADDED) ===== */
.table-container{
    width:100%;
    overflow-x:auto;
}
table{
    width:100%;
    border-collapse: collapse;
    margin-top:10px;
    min-width:520px;
}
table, th, td{ border:1px solid #ccc; }
th, td{
    padding:12px;
    text-align:left;
    font-size: 16px;
}
th{ background:#007bff; color:white; }
</style>
</head>

<body>

<div class="header">
<h3>“তেলীপাড়া কুশ্বার পাড় আল জামিয়াতুল ইসলামিয়া দারুল উলুম মাদ্রাসার উদ্যোগে- তাফাসরুল কুরআন মাহফিল ”</h3>
<h4>মাহফিলের সকল কালেকশন এবং খরচ</h4>
</div>

<div class="card cardd" style="background:#010305">
<p style="font-size: 1.4rem;">মোট অনুদান: <span id="totalDonation">0</span></p>
<p style="font-size: 1.4rem;">মোট খরচ: <span id="totalExpense">0</span></p>
<p style="font-size: 1.4rem;">বর্তমান ক্যাশ: <span id="balance">0</span></p>
</div>

<div class="card" id="homeButtons">
<button onclick="showPage('donationList')">অনুদানের হিসাব</button> 
<button onclick="showPage('expenseList')">খরচের হিসাব</button>
<button onclick="showPasswordPrompt('donation')">অনুদান যোগ করুন</button> 
<button onclick="showPasswordPrompt('expense')">খরচ যোগ করুন</button>
</div>

<div class="card hidden" id="passwordDiv">
<input type="password" id="passwordInput" placeholder="পাসওয়ার্ড লিখুন">
<button onclick="checkPassword()">সাবমিট</button>
</div>

<div class="card hidden" id="donationFormDiv">
<input id="donorName" placeholder="দাতার নাম">
<input id="donorPhone" placeholder="ঠিকানা">
<input id="donorAmount" placeholder="টাকার পরিমাণ">
<button onclick="submitDonation()">সাবমিট</button>
<button onclick="backHome()">Back</button>
</div>

<div class="card hidden" id="expenseFormDiv">
<input id="expensePurpose" placeholder="কোন কাজে">
<input id="expenseBy" placeholder="কার মাধ্যমে">
<input id="expenseAmount" placeholder="টাকা">
<button onclick="submitExpense()">সাবমিট</button>
<button onclick="backHome()">Back</button>
</div>

<div class="card hidden" id="donationList">
<div class="table-container">
<table id="donationTable">
<tr><th>SL</th><th>Name</th><th>Address</th><th>Amount</th><th>Submitted By</th></tr>
</table>
</div>
<button onclick="downloadDonationPNG()">ডাউনলোড</button>
<button onclick="backHome()">Back</button>
</div>

<div class="card hidden" id="expenseList">
<div class="table-container">
<table id="expenseTable">
<tr><th>SL</th><th>Purpose</th><th>By</th><th>Amount</th><th>Submitted By</th></tr>
</table>
</div>
<button onclick="downloadExpensePNG()">ডাউনলোড</button>
<button onclick="backHome()">Back</button>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>

<script>
const DONATION_API="https://691c4c4e3aaeed735c90492a.mockapi.io/donations";
const EXPENSE_API="https://691c4c4e3aaeed735c90492a.mockapi.io/expense";

let currentForm="";
let submitted_by="";

/* Bengali → English number */
function bnToEnNumber(str){
    const bn="০১২৩৪৫৬৭৮৯";
    const en="0123456789";
    return str.split("").map(c=>bn.includes(c)?en[bn.indexOf(c)]:c).join("");
}

/* PASSWORD */
function showPasswordPrompt(form){
    currentForm=form;
    homeButtons.classList.add("hidden");
    passwordDiv.classList.remove("hidden");
}
function checkPassword(){
    let p=passwordInput.value;
    if(p==="1122") submitted_by="Abdullah";
    else if(p==="1133") submitted_by="Sadat";
    else if(p==="2255") submitted_by="Shahadot";
    else{ alert("ভুল পাসওয়ার্ড"); return; }

    passwordDiv.classList.add("hidden");
    passwordInput.value="";
    if(currentForm==="donation") donationFormDiv.classList.remove("hidden");
    else expenseFormDiv.classList.remove("hidden");
}

/* SUBMIT */
function submitDonation(){
fetch(DONATION_API,{
method:"POST",
headers:{"Content-Type":"application/json"},
body:JSON.stringify({
name:donorName.value,
phone:donorPhone.value,
amount:Number(bnToEnNumber(donorAmount.value)),
submitted_by
})
}).then(()=>{
alert("অনুদান যোগ হয়েছে");
donorName.value=""; donorPhone.value=""; donorAmount.value="";
loadTotals();
});
}

function submitExpense(){
fetch(EXPENSE_API,{
method:"POST",
headers:{"Content-Type":"application/json"},
body:JSON.stringify({
purpose:expensePurpose.value,
by:expenseBy.value,
amount:Number(bnToEnNumber(expenseAmount.value)),
submitted_by
})
}).then(()=>{
alert("খরচ যোগ হয়েছে");
expensePurpose.value=""; expenseBy.value=""; expenseAmount.value="";
loadTotals();
});
}

/* LIST */
function showPage(p){
homeButtons.classList.add("hidden");
p==="donationList"?(donationList.classList.remove("hidden"),loadDonationList()):
(expenseList.classList.remove("hidden"),loadExpenseList());
}

function loadDonationList(){
fetch(DONATION_API).then(r=>r.json()).then(data=>{
donationTable.innerHTML="<tr><th>SL</th><th>Name</th><th>Address</th><th>Amount</th><th>Submitted By</th></tr>";
let i=1;
data.forEach(d=>{
let r=donationTable.insertRow();
r.insertCell(0).innerText=i++;
r.insertCell(1).innerText=d.name;
r.insertCell(2).innerText=d.phone;
r.insertCell(3).innerText=bnToEnNumber(String(d.amount));
r.insertCell(4).innerText=d.submitted_by||"";
});
});
}

function loadExpenseList(){
fetch(EXPENSE_API).then(r=>r.json()).then(data=>{
expenseTable.innerHTML="<tr><th>SL</th><th>Purpose</th><th>By</th><th>Amount</th><th>Submitted By</th></tr>";
let i=1;
data.forEach(d=>{
let r=expenseTable.insertRow();
r.insertCell(0).innerText=i++;
r.insertCell(1).innerText=d.purpose;
r.insertCell(2).innerText=d.by;
r.insertCell(3).innerText=bnToEnNumber(String(d.amount));
r.insertCell(4).innerText=d.submitted_by||"";
});
});
}

/* TOTAL */
function loadTotals(){
Promise.all([
fetch(DONATION_API).then(r=>r.json()),
fetch(EXPENSE_API).then(r=>r.json())
]).then(([d,e])=>{
totalDonation.innerText=d.reduce((a,b)=>a+Number(b.amount),0);
totalExpense.innerText=e.reduce((a,b)=>a+Number(b.amount),0);
balance.innerText=totalDonation.innerText-totalExpense.innerText;
});
}

function backHome(){
donationFormDiv.classList.add("hidden");
expenseFormDiv.classList.add("hidden");
donationList.classList.add("hidden");
expenseList.classList.add("hidden");
homeButtons.classList.remove("hidden");
}

/* DOWNLOAD */
function downloadDonationPNG(){
html2canvas(donationList).then(c=>{
let a=document.createElement("a");
a.download="donation.png";
a.href=c.toDataURL();
a.click();
});
}
function downloadExpensePNG(){
html2canvas(expenseList).then(c=>{
let a=document.createElement("a");
a.download="expense.png";
a.href=c.toDataURL();
a.click();
});
}

loadTotals();
</script>

</body>
</html>
